(define categories (list 'monkey 'dog 'cat 'hyena 'kitten 'penguin 'man))
(define (categories-prior) (multinomial categories '(0.00166666666667 0.00166666666667 0.00166666666667 0.00166666666667 0.00166666666667 0.00166666666667 0.99)))
(define utterances categories)
(define costs '(1 1 1 1 1 1 1))
(define (utterance-prior) (multinomial utterances (map (lambda (utterance-cost) (exp (- utterance-cost))) costs)))
(define funny (list 0 1 2 3 4 5))
(define (funny-prior category)
(case category
	(('monkey) (multinomial funny (list 0.2 0.05 0.2 0.15 0.1 0.3)))
	(('dog) (multinomial funny (list 0.1 0.05 0.15 0.25 0.35 0.1)))
	(('cat) (multinomial funny (list 0.2 0.05 0.2 0.15 0.2 0.2)))
	(('hyena) (multinomial funny (list 0.15 0.25 0.15 0.2 0.15 0.1)))
	(('kitten) (multinomial funny (list 0.1 0.1 0.15 0.15 0.25 0.25)))
	(('penguin) (multinomial funny (list 0.15 0.1 0.1 0.2 0.3 0.15)))
	(('man) (multinomial funny (list 0.1 0.05 0.15 0.2 0.2 0.3)))
))
(define lazy (list 0 1 2 3 4 5))
(define (lazy-prior category)
(case category
	(('monkey) (multinomial lazy (list 0.173913043478261 0.217391304347826 0.173913043478261 0.260869565217391 0.0869565217391304 0.0869565217391304)))
	(('dog) (multinomial lazy (list 0.260869565217391 0.0869565217391304 0.0869565217391304 0.260869565217391 0.217391304347826 0.0869565217391304)))
	(('cat) (multinomial lazy (list 0.0869565217391304 0.130434782608696 0.173913043478261 0.0869565217391304 0.173913043478261 0.347826086956522)))
	(('hyena) (multinomial lazy (list 0.260869565217391 0.130434782608696 0.304347826086957 0.173913043478261 0.0434782608695652 0.0869565217391304)))
	(('kitten) (multinomial lazy (list 0.130434782608696 0.173913043478261 0.130434782608696 0.0869565217391304 0.260869565217391 0.217391304347826)))
	(('penguin) (multinomial lazy (list 0.260869565217391 0.0869565217391304 0.347826086956522 0.173913043478261 0.0869565217391304 0.0434782608695652)))
	(('man) (multinomial lazy (list 0.173913043478261 0.130434782608696 0.0869565217391304 0.173913043478261 0.304347826086957 0.130434782608696)))
))
(define cute (list 0 1 2 3 4 5))
(define (cute-prior category)
(case category
	(('monkey) (multinomial cute (list 0.173913043478261 0.0869565217391304 0.173913043478261 0.260869565217391 0.217391304347826 0.0869565217391304)))
	(('dog) (multinomial cute (list 0.0434782608695652 0.0869565217391304 0.0869565217391304 0.130434782608696 0.347826086956522 0.304347826086957)))
	(('cat) (multinomial cute (list 0.0434782608695652 0.0434782608695652 0.130434782608696 0.173913043478261 0.347826086956522 0.260869565217391)))
	(('hyena) (multinomial cute (list 0.521739130434783 0.130434782608696 0.130434782608696 0.0869565217391304 0.0869565217391304 0.0434782608695652)))
	(('kitten) (multinomial cute (list 0.0434782608695652 0.0434782608695652 0.0434782608695652 0.173913043478261 0.130434782608696 0.565217391304348)))
	(('penguin) (multinomial cute (list 0.0869565217391304 0.0869565217391304 0.173913043478261 0.130434782608696 0.304347826086957 0.217391304347826)))
	(('man) (multinomial cute (list 0.130434782608696 0.173913043478261 0.217391304347826 0.173913043478261 0.173913043478261 0.130434782608696)))
))
(define playful (list 0 1 2 3 4 5))
(define (playful-prior category)
(case category
	(('monkey) (multinomial playful (list 0.0526315789473684 0.0526315789473684 0.105263157894737 0.157894736842105 0.421052631578947 0.210526315789474)))
	(('dog) (multinomial playful (list 0.0526315789473684 0.0526315789473684 0.0526315789473684 0.0526315789473684 0.368421052631579 0.421052631578947)))
	(('cat) (multinomial playful (list 0.0526315789473684 0.0526315789473684 0.105263157894737 0.210526315789474 0.421052631578947 0.157894736842105)))
	(('hyena) (multinomial playful (list 0.263157894736842 0.210526315789474 0.105263157894737 0.210526315789474 0.157894736842105 0.0526315789473684)))
	(('kitten) (multinomial playful (list 0.0526315789473684 0.0526315789473684 0.0526315789473684 0.105263157894737 0.157894736842105 0.578947368421053)))
	(('penguin) (multinomial playful (list 0.105263157894737 0.210526315789474 0.263157894736842 0.210526315789474 0.157894736842105 0.0526315789473684)))
	(('man) (multinomial playful (list 0.0526315789473684 0.105263157894737 0.105263157894737 0.210526315789474 0.157894736842105 0.368421052631579)))
))
(define loyal (list 0 1 2 3 4 5))
(define (loyal-prior category)
(case category
	(('monkey) (multinomial loyal (list 0.277777777777778 0.111111111111111 0.222222222222222 0.166666666666667 0.0555555555555556 0.166666666666667)))
	(('dog) (multinomial loyal (list 0.0555555555555556 0.111111111111111 0.0555555555555556 0.166666666666667 0.277777777777778 0.333333333333333)))
	(('cat) (multinomial loyal (list 0.0555555555555556 0.166666666666667 0.111111111111111 0.333333333333333 0.222222222222222 0.111111111111111)))
	(('hyena) (multinomial loyal (list 0.444444444444444 0.222222222222222 0.0555555555555556 0.0555555555555556 0.111111111111111 0.111111111111111)))
	(('kitten) (multinomial loyal (list 0.166666666666667 0.0555555555555556 0.222222222222222 0.222222222222222 0.222222222222222 0.111111111111111)))
	(('penguin) (multinomial loyal (list 0.277777777777778 0.166666666666667 0.0555555555555556 0.222222222222222 0.166666666666667 0.111111111111111)))
	(('man) (multinomial loyal (list 0.0555555555555556 0.0555555555555556 0.166666666666667 0.222222222222222 0.333333333333333 0.166666666666667)))
))
(define loud (list 0 1 2 3 4 5))
(define (loud-prior category)
(case category
	(('monkey) (multinomial loud (list 0.136363636363636 0.0909090909090909 0.227272727272727 0.409090909090909 0.0454545454545455 0.0909090909090909)))
	(('dog) (multinomial loud (list 0.0454545454545455 0.227272727272727 0.136363636363636 0.272727272727273 0.181818181818182 0.136363636363636)))
	(('cat) (multinomial loud (list 0.181818181818182 0.5 0.136363636363636 0.0454545454545455 0.0909090909090909 0.0454545454545455)))
	(('hyena) (multinomial loud (list 0.0454545454545455 0.363636363636364 0.227272727272727 0.181818181818182 0.136363636363636 0.0454545454545455)))
	(('kitten) (multinomial loud (list 0.318181818181818 0.409090909090909 0.0909090909090909 0.0454545454545455 0.0454545454545455 0.0909090909090909)))
	(('penguin) (multinomial loud (list 0.454545454545455 0.272727272727273 0.0909090909090909 0.0909090909090909 0.0454545454545455 0.0454545454545455)))
	(('man) (multinomial loud (list 0.0909090909090909 0.0454545454545455 0.272727272727273 0.227272727272727 0.181818181818182 0.181818181818182)))
))
(define friendly (list 0 1 2 3 4 5))
(define (friendly-prior category)
(case category
	(('monkey) (multinomial friendly (list 0.05 0.25 0.35 0.15 0.1 0.1)))
	(('dog) (multinomial friendly (list 0.05 0.05 0.05 0.1 0.05 0.7)))
	(('cat) (multinomial friendly (list 0.1 0.05 0.2 0.2 0.15 0.3)))
	(('hyena) (multinomial friendly (list 0.45 0.25 0.1 0.1 0.05 0.05)))
	(('kitten) (multinomial friendly (list 0.05 0.05 0.1 0.2 0.25 0.35)))
	(('penguin) (multinomial friendly (list 0.15 0.25 0.2 0.15 0.2 0.05)))
	(('man) (multinomial friendly (list 0.15 0.05 0.1 0.2 0.25 0.25)))
))
(define smart (list 0 1 2 3 4 5))
(define (smart-prior category)
(case category
	(('monkey) (multinomial smart (list 0.0416666666666667 0.0416666666666667 0.166666666666667 0.291666666666667 0.25 0.208333333333333)))
	(('dog) (multinomial smart (list 0.0416666666666667 0.166666666666667 0.25 0.125 0.333333333333333 0.0833333333333333)))
	(('cat) (multinomial smart (list 0.0833333333333333 0.125 0.125 0.25 0.375 0.0416666666666667)))
	(('hyena) (multinomial smart (list 0.0833333333333333 0.125 0.416666666666667 0.25 0.0833333333333333 0.0416666666666667)))
	(('kitten) (multinomial smart (list 0.208333333333333 0.25 0.125 0.208333333333333 0.166666666666667 0.0416666666666667)))
	(('penguin) (multinomial smart (list 0.125 0.208333333333333 0.333333333333333 0.208333333333333 0.0833333333333333 0.0416666666666667)))
	(('man) (multinomial smart (list 0.0416666666666667 0.0416666666666667 0.0833333333333333 0.125 0.0833333333333333 0.625)))
))
(define goals (list 'category? 'funny? 'lazy? 'cute? 'playful? 'loyal? 'loud? 'friendly? 'smart?))
(define (goal-prior) (uniform-draw goals))
(define lit-listener (mem (lambda (utterance goal)
(enumeration-query
(define category utterance)
(define feature
	(case goal
		(('category?) category)
		(('funny?) (funny-prior category))
		(('lazy?) (lazy-prior category))
		(('cute?) (cute-prior category))
		(('playful?) (playful-prior category))
		(('loyal?) (loyal-prior category))
		(('loud?) (loud-prior category))
		(('friendly?) (friendly-prior category))
		(('smart?) (smart-prior category))
))
feature
#t))))
(define speaker (mem (lambda 
(category funny lazy cute playful loyal loud friendly smart goal)
(enumeration-query
(define utterance (utterance-prior))
(define dimension
	(case goal
		(('category?) category)
		(('funny?) funny)
		(('lazy?) lazy)
		(('cute?) cute)
		(('playful?) playful)
		(('loyal?) loyal)
		(('loud?) loud)
		(('friendly?) friendly)
		(('smart?) smart)
))
utterance
(equal? (apply multinomial (lit-listener utterance goal)) dimension)))))
(define listener (mem (lambda (utterance)
(enumeration-query
(define category (categories-prior))
(define funny (funny-prior category))
(define lazy (lazy-prior category))
(define cute (cute-prior category))
(define playful (playful-prior category))
(define loyal (loyal-prior category))
(define loud (loud-prior category))
(define friendly (friendly-prior category))
(define smart (smart-prior category))
(define speaker-goal (goal-prior))
(list category funny lazy cute playful loyal loud friendly smart)
(equal? utterance (apply multinomial (raise-to-power (speaker category funny lazy cute playful loyal loud friendly smart speaker-goal) alpha)))))))
(define (raise-to-power speaker-dist alpha) (list (first speaker-dist) (map (lambda (x) (pow x alpha)) (second speaker-dist))))
(define alpha 3)
(define interpretation (listener 'penguin))
(write-csv (map flatten (zip (first interpretation) (second interpretation))) '/Users/justinek/Dropbox/Work/Grad_school/Research/Metaphor/metaphors/Model/SeedingModel/CoreAnimalsOutput/penguin_6_3.csv)