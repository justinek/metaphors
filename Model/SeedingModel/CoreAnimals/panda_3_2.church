(define categories (list 'elephant 'dog 'cat 'kitten 'whale 'panda 'man))
(define (categories-prior) (multinomial categories '(0.00166666666667 0.00166666666667 0.00166666666667 0.00166666666667 0.00166666666667 0.00166666666667 0.99)))
(define utterances categories)
(define costs '(1 1 1 1 1 1 1))
(define (utterance-prior) (multinomial utterances (map (lambda (utterance-cost) (exp (- utterance-cost))) costs)))
(define cute (list 0 1 2))
(define (cute-prior category)
(case category
	(('elephant) (multinomial cute (list 0.4 0.35 0.25)))
	(('dog) (multinomial cute (list 0.1 0.2 0.7)))
	(('cat) (multinomial cute (list 0.05 0.3 0.65)))
	(('kitten) (multinomial cute (list 0.05 0.2 0.75)))
	(('whale) (multinomial cute (list 0.6 0.2 0.2)))
	(('panda) (multinomial cute (list 0.05 0.35 0.6)))
	(('man) (multinomial cute (list 0.3 0.4 0.3)))
))
(define lazy (list 0 1 2))
(define (lazy-prior category)
(case category
	(('elephant) (multinomial lazy (list 0.4 0.4 0.2)))
	(('dog) (multinomial lazy (list 0.35 0.35 0.3)))
	(('cat) (multinomial lazy (list 0.2 0.25 0.55)))
	(('kitten) (multinomial lazy (list 0.3 0.2 0.5)))
	(('whale) (multinomial lazy (list 0.5 0.25 0.25)))
	(('panda) (multinomial lazy (list 0.1 0.45 0.45)))
	(('man) (multinomial lazy (list 0.3 0.25 0.45)))
))
(define big (list 0 1 2))
(define (big-prior category)
(case category
	(('elephant) (multinomial big (list 0.0714285714285714 0.0714285714285714 0.857142857142857)))
	(('dog) (multinomial big (list 0.571428571428571 0.357142857142857 0.0714285714285714)))
	(('cat) (multinomial big (list 0.714285714285714 0.214285714285714 0.0714285714285714)))
	(('kitten) (multinomial big (list 0.785714285714286 0.142857142857143 0.0714285714285714)))
	(('whale) (multinomial big (list 0.0714285714285714 0.142857142857143 0.785714285714286)))
	(('panda) (multinomial big (list 0.142857142857143 0.714285714285714 0.142857142857143)))
	(('man) (multinomial big (list 0.285714285714286 0.642857142857143 0.0714285714285714)))
))
(define hard (list 0 1 2))
(define (hard-prior category)
(case category
	(('elephant) (multinomial hard (list 0.333333333333333 0.333333333333333 0.333333333333333)))
	(('dog) (multinomial hard (list 0.80952380952381 0.142857142857143 0.0476190476190476)))
	(('cat) (multinomial hard (list 0.857142857142857 0.0952380952380952 0.0476190476190476)))
	(('kitten) (multinomial hard (list 0.857142857142857 0.0952380952380952 0.0476190476190476)))
	(('whale) (multinomial hard (list 0.333333333333333 0.523809523809524 0.142857142857143)))
	(('panda) (multinomial hard (list 0.714285714285714 0.238095238095238 0.0476190476190476)))
	(('man) (multinomial hard (list 0.571428571428571 0.333333333333333 0.0952380952380952)))
))
(define playful (list 0 1 2))
(define (playful-prior category)
(case category
	(('elephant) (multinomial playful (list 0.3125 0.5 0.1875)))
	(('dog) (multinomial playful (list 0.0625 0.0625 0.875)))
	(('cat) (multinomial playful (list 0.0625 0.3125 0.625)))
	(('kitten) (multinomial playful (list 0.0625 0.125 0.8125)))
	(('whale) (multinomial playful (list 0.5 0.375 0.125)))
	(('panda) (multinomial playful (list 0.1875 0.625 0.1875)))
	(('man) (multinomial playful (list 0.125 0.3125 0.5625)))
))
(define loyal (list 0 1 2))
(define (loyal-prior category)
(case category
	(('elephant) (multinomial loyal (list 0.533333333333333 0.266666666666667 0.2)))
	(('dog) (multinomial loyal (list 0.133333333333333 0.2 0.666666666666667)))
	(('cat) (multinomial loyal (list 0.2 0.466666666666667 0.333333333333333)))
	(('kitten) (multinomial loyal (list 0.2 0.466666666666667 0.333333333333333)))
	(('whale) (multinomial loyal (list 0.733333333333333 0.133333333333333 0.133333333333333)))
	(('panda) (multinomial loyal (list 0.6 0.2 0.2)))
	(('man) (multinomial loyal (list 0.0666666666666667 0.4 0.533333333333333)))
))
(define majestic (list 0 1 2))
(define (majestic-prior category)
(case category
	(('elephant) (multinomial majestic (list 0.0588235294117647 0.294117647058824 0.647058823529412)))
	(('dog) (multinomial majestic (list 0.176470588235294 0.529411764705882 0.294117647058824)))
	(('cat) (multinomial majestic (list 0.176470588235294 0.529411764705882 0.294117647058824)))
	(('kitten) (multinomial majestic (list 0.529411764705882 0.352941176470588 0.117647058823529)))
	(('whale) (multinomial majestic (list 0.117647058823529 0.411764705882353 0.470588235294118)))
	(('panda) (multinomial majestic (list 0.294117647058824 0.470588235294118 0.235294117647059)))
	(('man) (multinomial majestic (list 0.411764705882353 0.294117647058824 0.294117647058824)))
))
(define friendly (list 0 1 2))
(define (friendly-prior category)
(case category
	(('elephant) (multinomial friendly (list 0.176470588235294 0.411764705882353 0.411764705882353)))
	(('dog) (multinomial friendly (list 0.0588235294117647 0.117647058823529 0.823529411764706)))
	(('cat) (multinomial friendly (list 0.117647058823529 0.411764705882353 0.470588235294118)))
	(('kitten) (multinomial friendly (list 0.0588235294117647 0.294117647058824 0.647058823529412)))
	(('whale) (multinomial friendly (list 0.529411764705882 0.235294117647059 0.235294117647059)))
	(('panda) (multinomial friendly (list 0.235294117647059 0.529411764705882 0.235294117647059)))
	(('man) (multinomial friendly (list 0.176470588235294 0.294117647058824 0.529411764705882)))
))
(define goals (list 'category? 'cute? 'lazy? 'big? 'hard? 'playful? 'loyal? 'majestic? 'friendly?))
(define (goal-prior) (uniform-draw goals))
(define lit-listener (mem (lambda (utterance goal)
(enumeration-query
(define category utterance)
(define feature
	(case goal
		(('category?) category)
		(('cute?) (cute-prior category))
		(('lazy?) (lazy-prior category))
		(('big?) (big-prior category))
		(('hard?) (hard-prior category))
		(('playful?) (playful-prior category))
		(('loyal?) (loyal-prior category))
		(('majestic?) (majestic-prior category))
		(('friendly?) (friendly-prior category))
))
feature
#t))))
(define speaker (mem (lambda 
(category cute lazy big hard playful loyal majestic friendly goal)
(enumeration-query
(define utterance (utterance-prior))
(define dimension
	(case goal
		(('category?) category)
		(('cute?) cute)
		(('lazy?) lazy)
		(('big?) big)
		(('hard?) hard)
		(('playful?) playful)
		(('loyal?) loyal)
		(('majestic?) majestic)
		(('friendly?) friendly)
))
utterance
(equal? (apply multinomial (lit-listener utterance goal)) dimension)))))
(define listener (mem (lambda (utterance)
(enumeration-query
(define category (categories-prior))
(define cute (cute-prior category))
(define lazy (lazy-prior category))
(define big (big-prior category))
(define hard (hard-prior category))
(define playful (playful-prior category))
(define loyal (loyal-prior category))
(define majestic (majestic-prior category))
(define friendly (friendly-prior category))
(define speaker-goal (goal-prior))
(list category cute lazy big hard playful loyal majestic friendly)
(equal? utterance (apply multinomial (raise-to-power (speaker category cute lazy big hard playful loyal majestic friendly speaker-goal) alpha)))))))
(define (raise-to-power speaker-dist alpha) (list (first speaker-dist) (map (lambda (x) (pow x alpha)) (second speaker-dist))))
(define alpha 2)
(define interpretation (listener 'panda))
(write-csv (map flatten (zip (first interpretation) (second interpretation))) '/Users/justinek/Dropbox/Work/Grad_school/Research/Metaphor/metaphors/Model/SeedingModel/CoreAnimalsOutput/panda_3_2.csv)